# Spatial Statistics: Reproducing Kernel Hilbert Space (RKHS)
## Definition and Properties

## Construction of RKHS
### Moore-Aronszajn Theorem
**Theorem** (Moore-Aronszajn). RKHS and positive definite kernel are one-to-one correspondent, i.e., for each positive definite kernel $k(\cdot,\cdot)$, there exists a unique RKHS with $k(\cdot,\cdot)$ as its reproducing kernel.

**Proof.** Let $\mathcal{X}$ be a non-empty set and $k(\cdot,\cdot)$ be a positive definite kernel on $\mathcal{X}\times\mathcal{X}$. Define

$$\mathcal{H}_ 0 = \mathrm{span} \left\lbrace k(\cdot, x): x\in\mathcal{X}\right\rbrace = \left\lbrace\sum_{i=1}^n c_i k(\cdot,x_i): n\in\mathbb{N},\ c_1,\cdots,c_n\in\mathbb{R},\ x_1,\cdots,x_n\in\mathcal{X}\right\rbrace,$$

then $\mathcal{H}_ 0$ is a pre-Hilbert space with inner product
$$\left\langle f,g \right\rangle_{\mathcal{H}_ 0} = \sum_{i=1}^m\sum_{j=1}^n a_i b_j k(x_i, y_j),$$
where $f,g\in\mathcal{H}_ 0$ have representations
$$f=\sum_{i=1}^m a_i k(\cdot, x_i),\ g=\sum_{j=1}^n b_j k(\cdot, y_j),\ x_1,\cdots,x_m,y_1,\cdots,y_n\in\mathcal{X}.$$
Let $\mathcal{H}$ be the closure of $\mathcal{H}_0$ under $\Vert\cdot\Vert _{\mathcal{H}_0} = \langle\cdot,\cdot\rangle _{\mathcal{H}_0}$, i.e., $\mathcal{H}$ consists of functions $f\in\mathbb{R}^\mathcal{X}$ of the form

$$f=\sum_{i=1}^\infty {c_i}k(\cdot,x_i),\ \text{with}\ \lim_{n\to\infty}\sup_{m\in\mathbb{N}^*}\left\Vert\sum_{i=n+1}^{n+m} c_ik(\cdot, x_i)\right\Vert _{\mathcal{H}_0} = 0.$$

We claim that $\mathcal{H}$ is a RKHS with $k(\cdot,\cdot)$ as its reproducing kernel. To show this it suffices to check the reproducing property: $\forall x \in\mathcal{X}$,

$$\left\langle f, k(\cdot, x)\right\rangle_{\mathcal{H}} = \left\langle \sum_{i=1}^\infty {c_i}k(\cdot,x_i), k(\cdot, x)\right\rangle_{\mathcal{H}} = \sum_{i=1}^\infty {c_i}\left\langle k(\cdot,x_i), k(\cdot, x)\right\rangle_{\mathcal{H}_ 0} = \sum_{i=1}^\infty c_i k(x,x_i) = f(x).$$

Now we prove that $\mathcal{H}$ is unique. Suppose that $\tilde{\mathcal{H}}$ is another RKHS with $k(\cdot,\cdot)$ as its reproducing kernel. By property (I), $\mathcal{H}_ 0 \subset\tilde{\mathcal{H}}$, and $\langle\cdot,\cdot\rangle_{\mathcal{H}}=\langle\cdot,\cdot\rangle_{\tilde{\mathcal{H}}}$ on $\mathcal{H}_0$. Since $\tilde{\mathcal{H}}$ is complete, it contains the closure of $\mathcal{H}_0$, i.e. $\mathcal{H}\subseteq\tilde{\mathcal{H}}$. it remains to prove that $\mathcal{H}\supseteq\tilde{\mathcal{H}}$.

Let $\tilde{\mathcal{H}} = \mathcal{H}\oplus\mathcal{H}^\perp$, $\forall f\in\tilde{\mathcal{H}}$, it can be decomposed as $f=f^* + f^\perp$, where $f^*\in\mathcal{H},f^\perp\in\mathcal{H}^\perp$, then $\forall x\in\mathcal{X}$,

<p>
$$f(x) = \langle f, k(\cdot, x)\rangle_ {\tilde{\mathcal{H}}} = \langle f^*, k(\cdot,x)\rangle_ {\tilde{\mathcal{H}}} + \langle f^\perp,k(\cdot,x)\rangle _{\tilde{\mathcal{H}}} = \langle f^*, k(\cdot,x)\rangle_{\tilde{\mathcal{H}}} = \langle f^*, k(\cdot,x)\rangle_{\mathcal{H}} = f^*(x),$$
</p>

which implies $f^\perp = 0$ on $\mathcal{X}$. Hence $f=f^*\in\mathcal{H}$, which concludes the proof.

### Mercer's Theorem
**Assumption** In the following discussion, we fix the domain $\mathcal{X}$ as a compact set, and we make the following four assumptions of our kernel function $k:\mathcal{X}\times\mathcal{X}\to\mathbb{R}$.

(I) Continuous: $k$ is continuous on $\mathcal{X}\times\mathcal{X}$;

(II) Symmetric: $\forall x, y\in\mathcal{X},\ k(x,y) = k(y,x)$;

(III) Square integrable: $\int_\mathcal{X}\int_\mathcal{X}k(x,y)^2\mathrm{d}x\mathrm{d}y < \infty$;

(IV) Positive-definite:  $\forall f\in L_2(\mathcal{X}),\ \int_\mathcal{X}\int_\mathcal{X} f(x)k(x,y)f(y)\mathrm{d}x\mathrm{d}y \geq 0.$

**Definition** (Integral operator). Fix a kernel $k:\mathcal{X}\times\mathcal{X}\to\mathbb{R}$ on a compact set $\mathcal{X}\subset\mathbb{R}^d$, the operator $T_k:L_2(\mathcal{X})\to\mathcal{X}$ is defined as

$$T_k[f] (\cdot) := \int_\mathcal{X} k(\cdot, x)f(x)\mathrm{d}x,\ \ f\in L_2(\mathcal{X}).$$

$T_k$ is said to be positive definite if $\forall f\in L_2(\mathcal{X})\$, it holds $\left\langle f, T_k[f]\right\rangle_{L_2(\mathcal{X})} \geq 0$, that is,
<p>
  $$\int_\mathcal{X}\int_\mathcal{X} f(x)k(x,y)f(y)\mathrm{d}x\mathrm{d}y \geq 0.$$
</p>

**Properties.** The integral operator given by the definition above have following properties:
+ (Linear) $T_k[\alpha f + \beta g] = \alpha T_k[f] + \beta T_k[g],\ \alpha,\beta\in\mathbb{R},\ f,g\in L_2(\mathcal{X})$;
+ (Bounded) By Cauchy-Schwarz inequality,
  <p>
    $$\left\vert T_k[f](x)\right\vert^2 \leq \left(\int_\mathcal{X}k(x,y)^2\mathrm{d}y\right)\left(\int_\mathcal{X}f(y)^2\mathrm{d}y\right),$$
  </p>
  furthermore,
  <p>
    $$\left\Vert T_k[f]\right\Vert_{L_2(\mathcal{X})} \leq C_k\Vert f\Vert^2_{L_2(\mathcal{X})},\ C_k = \left(\int_\mathcal{X}\int_\mathcal{X}k(x,y)^2\mathrm{d}x\mathrm{d}y\right)^{1/2};$$
  </p>
+ (Symmetric/Self adjoint)
   <p>
     $$\left\langle T_k[f], g \right\rangle_{L_2(\mathcal{X})} = \left\langle f, T_k[g]\right\rangle_{L_2(\mathcal{X})},\ f,g\in L_2(\mathcal{X}).$$
   </p>
**Theorem** (Mercer). 

