# Spatial Statistics: Karhunen-Loève Expansion
## Kosambi-Karhunen-Loève Theorem
Let $\mathcal{X}$ be a compact set and $(\Omega,\mathcal{F},\mathbb{P})$ be a probability space. Given a second order process $\lbrace X(s) \in L_2(\Omega): s\in\mathcal{X} \rbrace$ over $(\Omega,\mathcal{F},\mathbb{P})$ with zero mean and continuous covariance function $k(\cdot,\cdot),$ then $(k(\cdot,\cdot)$ is a Mercer's kernel, i.e. there exists $\lbrace \lambda_ l\rbrace_ {l\in\mathbb{N}^{\*}}$ such that $\lambda_1\geq\lambda_2\geq\cdots\geq 0$ and an orthogonal basis $\lbrace \phi_l\rbrace_{l\in\mathbb{N}^*}\subset L_2(\Omega),$
<p>
  $$k(s,t) = \sum_{l=1}^\infty \lambda_l\phi_l(s)\phi_l(t),\ \forall s,t\in\mathcal{X}.$$
</p>

**Theorem** (Kosambi-Karhunen-Loève). The process $X(\cdot)$ defined above admits the following expansion:
<p>
  $$X(t) = \sum_{l=1}^\infty\sqrt{\lambda_l}\xi_l\phi_l(t),$$
</p>

where

<p>
  $$\xi_l = \frac{1}{\sqrt{\lambda_l}}\int_{\mathcal{X}} X(t)\phi_l(t)\mathrm{d}t,$$
</p>

and the convergence holds uniformly on $\mathcal{X}$ in $L_2$ sense. Furthermore, $\lbrace\xi_l\rbrace_{l\in\mathbb{N}^{\*}}$ are uncorrelated, with

<p>
  $$\mathbb{E}\xi_i=0,\ \mathrm{Cov}(\xi_i,\xi_{j}) = \delta_{ij},\ \forall i,j\in\mathbb{N}^*.$$
</p>

**Proof.** By definition,
<p>
  $$\begin{aligned}
  \mathbb{E}\xi_i &= \frac{1}{\sqrt{\lambda_i}}\int_{\mathcal{X}} X(t)\phi_i(t)\mathrm{d}t,\\
  \mathrm{Cov}(\xi_i,\xi_{j}) = \mathbb{E}[\xi_i,\xi_j] &= \frac{1}{\sqrt{\lambda_i}}\frac{1}{\sqrt{\lambda_j}}\int_\mathcal{X}\int_\mathcal{X}\mathbb{E}[X(s)X(t)]\phi_i(s)\phi_j(t)\mathrm{d}s\mathrm{d}t \\
  &= \frac{1}{\sqrt{\lambda_i}}\frac{1}{\sqrt{\lambda_j}}\int_\mathcal{X}\left(\int_\mathcal{X}k(s,t)\phi_i(s)\mathrm{d}s\right)\phi_j(t)\mathrm{d}t\\
  &= \frac{1}{\sqrt{\lambda_i}}\frac{1}{\sqrt{\lambda_j}}\int_\mathcal{X}\lambda_i\phi_i(t)\phi_j(t)\mathrm{d}t\\
  & = \frac{\lambda_i}{\sqrt{\lambda_i\lambda_j}}\int_\mathcal{X}\phi_i(t)\phi_j(t)\mathrm{d}t\\
  & = \frac{\lambda_i}{\sqrt{\lambda_i\lambda_j}}\delta_{ij} = \delta_{ij}.
  \end{aligned}$$
</p>

Also, we have
<p>
  $$\mathbb{E}[X(t)\xi_l] = \mathbb{E}$$
</p>

To show the convergence, we define $X_L(\cdot)$ as

<p>$$X_L(t) = \sum_{l=1}^L\sqrt{\lambda_l}\xi_l\phi_l(t).$$</p>

**Remark.** If $X(\cdot)$ is finite dimensional, i.e. there exists some $N$ such that $\lambda_n = 0$ if $n>N,$ then the Karhunen-Loève expansion has a truncated version:
<p>
  $$X(t) = \sum_{l=1}^N\sqrt{\lambda_l}\xi_l\phi_l(t),$$
</p>

with

<p>
  $$\xi_n = \frac{1}{\sqrt{\lambda_n}}\int_{\mathcal{X}} X(t)\phi_n(t)\mathrm{d}t = \infty\cdot 0 = 0,\ n>N.$$
</p>
